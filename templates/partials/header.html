<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="shortcut icon" href="{{url_for('serve_resource', filename='favicon.ico')}}">
</head>
<header class="header-top">
    <div class="header">
        <div class="brand-logo">
            <a href="{{ url_for('home') }}">
                <img src="{{ url_for('serve_resource', filename='OCEAN-banner.png') }}" alt="">
            </a>
        </div>
        <div class="brand-title">
            <p1 class="app-brand-title font-scale-1">
                OCEAN
            </p1>
        </div>
        <div class="user-message">
            {% if g.user.is_authenticated %}You are signed in as {{ g.user.name }} ({{g.user.role.name}}){% else %}You are not signed in{% endif %}
        </div>
    </div>
    {% if session['snapshot_date'] %}
    <div id="warning-bar" style="background-color: red; color: white; padding: 10px; margin-top: 10px;">
        Archive mode: viewing snapshot date {{ session['snapshot_date'] }} (<a href="{{ url_for('reset_snapshot_in_session') }}">Exit View</a>)
    </div>
    {% endif %}
    <nav class="menu">
        <a href="/home" class="menu-item">Home</a>
        
        {% if g.user.is_authenticated %}

        <a href="/encounter" class="menu-item">Encounters</a>
            {% if g.user.role_id in [1,2] %}
            <a href="{{ url_for('admin.admin_dashboard') }}" class="menu-item">Admin</a>
            {% endif %}
        <a href="{{ url_for('auth.logout') }}" class="menu-item">Logout ({{ g.user.name }})</a>
        {% else %}
        <a href="/login" class="menu-item">Login</a>
        {% endif %}
    </nav>
</header>
<div id="flashMessages">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div class="flash-container" style="padding-top:0px;" role="alert">
        <div class="{% if category == 'success' %}success-message{% elif category == 'error' %}error-message{% endif %}"
            style="padding-top:10px; padding: 10px 10px">
            <span
                class="{% if category == 'success' %}success-message{% elif category == 'error' %}error-message{% endif %}">{{
                message }}</span>
            <button type="button" class="close" aria-label="Close" onclick="closeFlashMessage()">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="progress-bar-container">
                <div class="progress-bar"></div>
            </div>
        </div>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
</div>

<style>
    .font-scale-1 {
        font-size: 1.2em;
    }

    .app-brand-title {
        display: block;
        margin-left: 7px;
        border-left: 1px solid #202024;
        padding-left: 10px;
        line-height: 1.2;
        font-weight: normal;
    }

    
    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .brand-logo {
        display: flex;
        align-items: center;
        margin-left: 10px;
        margin-top: 10px;
        margin-bottom: 10px;
    }

    .brand-logo img {
        height: auto;
        width: 100%;
        max-width: 150px;
        margin-right: 10px; /* Adjust the margin as needed */
    }

    .brand-title {
        margin-left: 0; /* Align the brand title to the left */
        margin-top:10px;
        margin-bottom: 10px;
    }
    .user-message {
        margin-left: auto; /* Align the user message to the right */
        margin-right:10px;
    }

    .flash-container {
        position: relative;
        width: 100%;
        color: #000;
        margin-bottom: 0px;
    }

    .success-message {
        color: #155724;
        border-color: #155724;
        border-width: 3px;
        background-color: #d4edda;
        /* Background color for success messages */
    }

    .error-message {
        color: #721c24;
        background-color: #f8d7da;
        /* Background color for error messages */
    }

    .success-progress {
        background-color: #155724;
    }

    .error-progress {
        background-color: #721c24;
    }

    .close {
        position: relative;
        float: right;
        font-size: 1.3rem;
        font-weight: 500;
        line-height: 1;
        text-shadow: 0 1px 0 #fff;
        opacity: 0.5;
        background-color: transparent;
        border: 0;
        cursor: pointer;
    }

    .progress-bar-container {
        width: 100%;
        height: 3px;
        border-radius: 0px;
        margin-top: 0px;
        overflow: hidden;
    }

    .progress-bar {
        width: 100%;
        height: 3px;
        border-radius: 0;
        transition: width 1s linear;
    }

    .progress {
        margin-top: 10px;
    }
</style>

<script>
    function closeFlashMessage() {
        // Get all flash containers and remove them from the DOM
        const flashContainers = document.querySelectorAll('.flash-container');
        flashContainers.forEach(container => {
            container.remove();
        });
    }
</script>

</html>